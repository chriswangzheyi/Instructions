# B树，B+树，B*树，R树

## B树

B树（英语：B-tree）是一种自平衡的树，能够保持数据有序。这种数据结构能够让查找数据、顺序访问、插入数据及删除的动作，都在对数时间内完成。B树，概括来说是一个一般化的二叉查找树（binary search tree），可以拥有最多2个子节点。与自平衡二叉查找树不同，B树适用于读写相对大的数据块的存储系统，例如磁盘。

根结点至少有两个子女。

每个中间节点都包含k-1个元素和k个孩子，其中 m/2 <= k <= m

每一个叶子节点都包含k-1个元素，其中 m/2 <= k <= m

所有的叶子结点都位于同一层。

每个节点中的元素从小到大排列，节点当中k-1个元素正好是k个孩子包含的元素的值域分划。

![](../Images/10.png)


## B+树

是一种树数据结构，通常用于关系型数据库（如Mysql）和操作系统的文件系统中。B+ 树的特点是能够保持数据稳定有序，其插入与修改拥有较稳定的对数时间复杂度。B+ 树元素自底向上插入，这与二叉树恰好相反。

在B树基础上，为叶子结点增加链表指针（B树+叶子有序链表），所有关键字都在叶子结点 中出现，非叶子结点作为叶子结点的索引；B+树总是到叶子结点才命中。

b+树的非叶子节点不保存数据，只保存子树的临界值（最大或者最小），所以同样大小的节点，b+树相对于b树能够有更多的分支，使得这棵树更加矮胖，查询时做的IO操作次数也更少。

### 最核心的特点如下：

（1）多路非二叉

（2）只有叶子节点保存数据

（3）搜索时相当于二分查找

（4）增加了相邻接点的指向指针。


![](../Images/11.png)

![](../Images/14.png)

B+树查询时间复杂度固定是logn

Mysql作为一个关系型数据库，数据的关联性是非常强的，区间访问是常见的一种情况，B+树由于数据全部存储在叶子节点，并且通过指针串在一起，这样就很容易的进行区间遍历甚至全部遍历。


B+树更适合外部存储，也就是磁盘存储。由于内节点无 data 域，每个节点能索引的范围更大更精确

## B-树

B-树是一种自平衡的搜索树，形式很简单：

![](../Images/13.jpeg)

这就是一颗B-树。针对我们这个问题的最核心的特点如下：

（1）多路，非二叉树

（2）每个节点既保存索引，又保存数据

（3）搜索时相当于二分查找

在这里我们假定都已经了解了B树相关的结构

B-树查询复杂度最好是 O(1)

## B*树

是B+树的变体，在B+树的非根和非叶子结点再增加指向兄弟的指针

在B+树基础上，为非叶子结点也增加链表指针，将结点的最低利用率从1/2提高到2/3。

R树是用来做空间数据存储的树状数据结构。例如给地理位置，矩形和多边形这类多维数据建立索引。


## R树

核心思想是聚合距离相近的节点并在树结构的上一层将其表示为这些节点的最小外接矩形（MBR），这个最小外接矩形就成为上一层的一个节点。因为所有节点都在它们的最小外接矩形中，所以跟某个矩形不相交的查询就一定跟这个矩形中的所有节点都不相交。叶子节点上的每个矩形都代表一个对象，节点都是对象的聚合，并且越往上层聚合的对象就越多。也可以把每一层看做是对数据集的近似，叶子节点层是最细粒度的近似，与数据集相似度100%，越往上层越粗糙。


![](../Images/12.png)


