# 3. Restful API

参考：http://kylin.apache.org/cn/docs/howto/howto_use_restapi.html#authentication

## 验证权限

![](Images/25.png)

API：

	localhost:7070/kylin/api/user/authentication
	
Header：

	Authorization：Basic QURNSU46S1lMSU4=
	
其中，账号名密码需要用base64加密， 

	python -c "import base64; print base64.standard_b64encode('$UserName:$Password')"
	
或者访问

https://www.sojson.com/base64.html

使用

	ADMIN:KYLIN
	

## Query

API：

localhost:7070/kylin/api/query

![](Images/26.png)

	Authorization：Basic QURNSU46S1lMSU4=
	Content-Type application/json


![](Images/27.png)

	{  
	   "sql":"select * from DWS_PV_SE",
	   "offset":0,
	   "limit":50000,
	   "acceptPartial":false,
	   "project":"learn_kylin"
	}
	
其中cube构建后的事实表名字来自于：

![](Images/28.png)


请求结果：

	{
	    "columnMetas": [
	        {
	            "isNullable": 1,
	            "displaySize": 256,
	            "label": "GUID",
	            "name": "GUID",
	            "schemaName": null,
	            "catelogName": null,
	            "tableName": null,
	            "precision": 256,
	            "scale": 0,
	            "columnType": 12,
	            "columnTypeName": "VARCHAR",
	            "autoIncrement": false,
	            "caseSensitive": true,
	            "searchable": false,
	            "currency": false,
	            "signed": true,
	            "writable": false,
	            "definitelyWritable": false,
	            "readOnly": true
	        },
	        {
	            "isNullable": 1,
	            "displaySize": 256,
	            "label": "SESSION_ID",
	            "name": "SESSION_ID",
	            "schemaName": null,
	            "catelogName": null,
	            "tableName": null,
	            "precision": 256,
	            "scale": 0,
	            "columnType": 12,
	            "columnTypeName": "VARCHAR",
	            "autoIncrement": false,
	            "caseSensitive": true,
	            "searchable": false,
	            "currency": false,
	            "signed": true,
	            "writable": false,
	            "definitelyWritable": false,
	            "readOnly": true
	        },
	        {
	            "isNullable": 1,
	            "displaySize": 10,
	            "label": "PV_CNT",
	            "name": "PV_CNT",
	            "schemaName": null,
	            "catelogName": null,
	            "tableName": null,
	            "precision": 10,
	            "scale": 0,
	            "columnType": 4,
	            "columnTypeName": "INTEGER",
	            "autoIncrement": false,
	            "caseSensitive": true,
	            "searchable": false,
	            "currency": false,
	            "signed": true,
	            "writable": false,
	            "definitelyWritable": false,
	            "readOnly": true
	        },
	        {
	            "isNullable": 1,
	            "displaySize": 256,
	            "label": "DEVICE_TYPE",
	            "name": "DEVICE_TYPE",
	            "schemaName": null,
	            "catelogName": null,
	            "tableName": null,
	            "precision": 256,
	            "scale": 0,
	            "columnType": 12,
	            "columnTypeName": "VARCHAR",
	            "autoIncrement": false,
	            "caseSensitive": true,
	            "searchable": false,
	            "currency": false,
	            "signed": true,
	            "writable": false,
	            "definitelyWritable": false,
	            "readOnly": true
	        },
	        {
	            "isNullable": 1,
	            "displaySize": 256,
	            "label": "PROVINCE",
	            "name": "PROVINCE",
	            "schemaName": null,
	            "catelogName": null,
	            "tableName": null,
	            "precision": 256,
	            "scale": 0,
	            "columnType": 12,
	            "columnTypeName": "VARCHAR",
	            "autoIncrement": false,
	            "caseSensitive": true,
	            "searchable": false,
	            "currency": false,
	            "signed": true,
	            "writable": false,
	            "definitelyWritable": false,
	            "readOnly": true
	        },
	        {
	            "isNullable": 1,
	            "displaySize": 256,
	            "label": "CITY",
	            "name": "CITY",
	            "schemaName": null,
	            "catelogName": null,
	            "tableName": null,
	            "precision": 256,
	            "scale": 0,
	            "columnType": 12,
	            "columnTypeName": "VARCHAR",
	            "autoIncrement": false,
	            "caseSensitive": true,
	            "searchable": false,
	            "currency": false,
	            "signed": true,
	            "writable": false,
	            "definitelyWritable": false,
	            "readOnly": true
	        },
	        {
	            "isNullable": 1,
	            "displaySize": 256,
	            "label": "REGION",
	            "name": "REGION",
	            "schemaName": null,
	            "catelogName": null,
	            "tableName": null,
	            "precision": 256,
	            "scale": 0,
	            "columnType": 12,
	            "columnTypeName": "VARCHAR",
	            "autoIncrement": false,
	            "caseSensitive": true,
	            "searchable": false,
	            "currency": false,
	            "signed": true,
	            "writable": false,
	            "definitelyWritable": false,
	            "readOnly": true
	        },
	        {
	            "isNullable": 1,
	            "displaySize": 256,
	            "label": "PAGE_ID",
	            "name": "PAGE_ID",
	            "schemaName": null,
	            "catelogName": null,
	            "tableName": null,
	            "precision": 256,
	            "scale": 0,
	            "columnType": 12,
	            "columnTypeName": "VARCHAR",
	            "autoIncrement": false,
	            "caseSensitive": true,
	            "searchable": false,
	            "currency": false,
	            "signed": true,
	            "writable": false,
	            "definitelyWritable": false,
	            "readOnly": true
	        },
	        {
	            "isNullable": 1,
	            "displaySize": 19,
	            "label": "DURATION",
	            "name": "DURATION",
	            "schemaName": null,
	            "catelogName": null,
	            "tableName": null,
	            "precision": 19,
	            "scale": 0,
	            "columnType": -5,
	            "columnTypeName": "BIGINT",
	            "autoIncrement": false,
	            "caseSensitive": true,
	            "searchable": false,
	            "currency": false,
	            "signed": true,
	            "writable": false,
	            "definitelyWritable": false,
	            "readOnly": true
	        },
	        {
	            "isNullable": 1,
	            "displaySize": 256,
	            "label": "DT",
	            "name": "DT",
	            "schemaName": null,
	            "catelogName": null,
	            "tableName": null,
	            "precision": 256,
	            "scale": 0,
	            "columnType": 12,
	            "columnTypeName": "VARCHAR",
	            "autoIncrement": false,
	            "caseSensitive": true,
	            "searchable": false,
	            "currency": false,
	            "signed": true,
	            "writable": false,
	            "definitelyWritable": false,
	            "readOnly": true
	        }
	    ],
	    "results": [],
	    "cube": "CUBE[name=dws_pv_se_model_1_cube_pcrd]",
	    "affectedRowCount": 0,
	    "isException": false,
	    "exceptionMessage": null,
	    "duration": 1692,
	    "totalScanCount": 0,
	    "totalScanBytes": 0,
	    "hitExceptionCache": false,
	    "storageCacheUsed": false,
	    "traceUrl": null,
	    "pushDown": false,
	    "partial": false
	}
