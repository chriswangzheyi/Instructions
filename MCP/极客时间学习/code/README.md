# MCP RAG åŒ»ç–—å¥åº·é—®ç­”ç³»ç»Ÿ

åŸºäº MCP (Model Context Protocol) å¿«é€Ÿæ­å»ºçš„ RAG (Retrieval-Augmented Generation) ç³»ç»Ÿï¼Œä¸“é—¨ç”¨äºåŒ»ç–—å¥åº·é¢†åŸŸçš„æ™ºèƒ½é—®ç­”ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒé…ç½®

é¡¹ç›®å·²ç»é…ç½®å¥½äº†è™šæ‹Ÿç¯å¢ƒå’Œä¾èµ–ï¼Œä½ åªéœ€è¦ï¼š

1. **é…ç½®APIå¯†é’¥**ï¼šç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œæ·»åŠ ä½ çš„APIå¯†é’¥ï¼š
   ```bash
   OPENAI_API_KEY=your_openai_api_key_here
   ANTHROPIC_API_KEY=your_anthropic_api_key_here  # å¯é€‰
   DEEPSEEK_API_KEY=your_deepseek_api_key_here    # å¯é€‰
   ```

2. **æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ**ï¼š
   ```bash
   source .venv/bin/activate
   ```

### 2. å¯åŠ¨æ–¹å¼

#### æ–¹å¼ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
# å¯åŠ¨æœåŠ¡å™¨
python run.py server

# å¯åŠ¨å®¢æˆ·ç«¯
python run.py client
```

#### æ–¹å¼äºŒï¼šä½¿ç”¨IDEç›´æ¥è¿è¡Œ

åœ¨ VS Code ä¸­ï¼š
1. æŒ‰ `F5` æˆ–ç‚¹å‡»"è¿è¡Œå’Œè°ƒè¯•"
2. é€‰æ‹©ä»¥ä¸‹é…ç½®ä¹‹ä¸€ï¼š
   - **å¯åŠ¨ RAG æœåŠ¡å™¨** - ç›´æ¥è¿è¡ŒæœåŠ¡å™¨
   - **å¯åŠ¨ RAG å®¢æˆ·ç«¯** - ç›´æ¥è¿è¡Œå®¢æˆ·ç«¯
   - **è¿è¡Œå¯åŠ¨è„šæœ¬ - æœåŠ¡å™¨** - é€šè¿‡è„šæœ¬å¯åŠ¨æœåŠ¡å™¨
   - **è¿è¡Œå¯åŠ¨è„šæœ¬ - å®¢æˆ·ç«¯** - é€šè¿‡è„šæœ¬å¯åŠ¨å®¢æˆ·ç«¯

#### æ–¹å¼ä¸‰ï¼šæ‰‹åŠ¨å¯åŠ¨

```bash
# å¯åŠ¨æœåŠ¡å™¨
.venv/bin/python rag-server/server.py

# å¯åŠ¨å®¢æˆ·ç«¯ï¼ˆæ–°ç»ˆç«¯ï¼‰
.venv/bin/python rag-client/client-v4-toolcalls-openai.py rag-server/server.py
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ rag-server/           # RAGæœåŠ¡å™¨
â”‚   â”œâ”€â”€ server.py         # ä¸»æœåŠ¡å™¨æ–‡ä»¶
â”‚   â”œâ”€â”€ server-ali.py     # é˜¿é‡Œäº‘ç‰ˆæœ¬
â”‚   â””â”€â”€ pyproject.toml    # ä¾èµ–é…ç½®
â”œâ”€â”€ rag-client/           # RAGå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ client-v4-toolcalls-openai.py  # OpenAIç‰ˆæœ¬å®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ client-v4-toolcalls-deepseek.py  # DeepSeekç‰ˆæœ¬å®¢æˆ·ç«¯
â”‚   â””â”€â”€ pyproject.toml    # ä¾èµ–é…ç½®
â”œâ”€â”€ .venv/                # Pythonè™šæ‹Ÿç¯å¢ƒ
â”œâ”€â”€ .env                  # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ run.py               # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ .vscode/             # VS Codeé…ç½®
â”‚   â”œâ”€â”€ launch.json      # è°ƒè¯•é…ç½®
â”‚   â””â”€â”€ settings.json    # ç¼–è¾‘å™¨è®¾ç½®
â””â”€â”€ è¯´æ˜.md              # è¯¦ç»†è¯´æ˜æ–‡æ¡£
```

## ğŸ”§ ç³»ç»Ÿæ¶æ„

### æœåŠ¡ç«¯åŠŸèƒ½
- **`index_docs(docs)`** - ç´¢å¼•æ–‡æ¡£é›†åˆï¼Œå­˜å‚¨å‘é‡åµŒå…¥
- **`retrieve_docs(query, top_k)`** - æ£€ç´¢æœ€ç›¸å…³çš„æ–‡æ¡£ç‰‡æ®µ

### å®¢æˆ·ç«¯åŠŸèƒ½
- **è¿æ¥ç®¡ç†** - ä½¿ç”¨ stdio_client å»ºç«‹è¿æ¥
- **å·¥å…·å‘ç°** - åŠ¨æ€è·å–æœåŠ¡å™¨å·¥å…·åˆ—è¡¨
- **æ™ºèƒ½è°ƒç”¨** - é€šè¿‡ LLM è‡ªåŠ¨é€‰æ‹©å’Œæ‰§è¡Œå·¥å…·

## ğŸ¯ ä½¿ç”¨åœºæ™¯

- **åŒ»ç–—å¥åº·é—®ç­”** - åŸºäºåŒ»å­¦æ–‡æ¡£çš„æ™ºèƒ½é—®ç­”
- **çŸ¥è¯†åº“æ£€ç´¢** - ä¼ä¸šæ–‡æ¡£çš„æ™ºèƒ½æ£€ç´¢
- **ä¸“ä¸šé¢†åŸŸå’¨è¯¢** - åŸºäºä¸“ä¸šæ–‡æ¡£çš„å’¨è¯¢æœåŠ¡

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **FastMCP** - MCPæœåŠ¡å™¨æ¡†æ¶
- **Faiss** - å‘é‡ç´¢å¼•å¼•æ“
- **OpenAI** - æ–‡æœ¬åµŒå…¥å’ŒLLM
- **Python 3.10+** - å¼€å‘è¯­è¨€

## ğŸ“ ä½¿ç”¨ç¤ºä¾‹

1. **å¯åŠ¨ç³»ç»Ÿ**ï¼š
   ```bash
   python run.py server  # ç»ˆç«¯1
   python run.py client  # ç»ˆç«¯2
   ```

2. **ç´¢å¼•æ–‡æ¡£**ï¼šç³»ç»Ÿä¼šè‡ªåŠ¨ç´¢å¼•é¢„è®¾çš„åŒ»å­¦æ–‡æ¡£

3. **å¼€å§‹é—®ç­”**ï¼š
   ```
   è¯·è¾“å…¥æ‚¨è¦æŸ¥è¯¢çš„åŒ»å­¦é—®é¢˜ï¼ˆè¾“å…¥'é€€å‡º'ç»“æŸæŸ¥è¯¢ï¼‰ï¼š
   > ä»€ä¹ˆæ˜¯ç³–å°¿ç—…ï¼Ÿ
   
   AI å›ç­”ï¼š
   ç³–å°¿ç—…æ˜¯ä¸€ç§æ…¢æ€§ä»£è°¢æ€§ç–¾ç—…ï¼Œä¸»è¦ç‰¹å¾æ˜¯è¡€ç³–æ°´å¹³æŒç»­å‡é«˜...
   ```

## ğŸ” æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **è™šæ‹Ÿç¯å¢ƒé—®é¢˜**ï¼š
   ```bash
   # é‡æ–°åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
   rm -rf .venv
   python3 -m venv .venv
   source .venv/bin/activate
   pip install -r requirements.txt
   ```

2. **APIå¯†é’¥é—®é¢˜**ï¼š
   - ç¡®ä¿ `.env` æ–‡ä»¶ä¸­çš„APIå¯†é’¥æ­£ç¡®
   - æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æœ‰è¶³å¤Ÿçš„é¢åº¦

3. **ä¾èµ–é—®é¢˜**ï¼š
   ```bash
   source .venv/bin/activate
   pip install --upgrade pip
   pip install faiss-cpu mcp[cli] openai anthropic python-dotenv numpy
   ```

## ğŸ“š æ›´å¤šä¿¡æ¯

è¯¦ç»†çš„æŠ€æœ¯è¯´æ˜è¯·æŸ¥çœ‹ `è¯´æ˜.md` æ–‡ä»¶ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼
