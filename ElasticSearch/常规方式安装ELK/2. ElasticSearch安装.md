# 2. ElasticSearch安装


## 修改linux配置

### 修改可打开的文件描述符数量

	vim /etc/security/limits.conf

在End of file前加上2行：

	* soft nofile 65536
	* hard nofile 65536

### 修改vm.max_map_count

	sysctl -w vm.max_map_count=262144

否则会报错 max virtual memory areas vm.max_map_count [65530] is too low, increase to at least [262144]


## 安装

	tar -xvzf elasticsearch-7.6.2-linux-x86_64.tar.gz


## 修改内存（非必须）

当服务器内存不够的时候，需要修改启动内存

	vi /root/elasticsearch-7.6.2/config/jvm.options

修改内存

	-Xms512M
	-Xmx512M


## 创建用户

	adduser es
	passwd es

## 因为无法在root文件夹下启动，需要移除

	mkdir /es
	mv /root/elasticsearch-7.6.2 /es
	chown -R es /es/elasticsearch-7.6.2

## 赋权

 chown -R es:es  /es


## 配置ElasticSearch

	vi /es/elasticsearch-7.6.2/config/elasticsearch.yml


插入：

	network.host: 0.0.0.0
	http.port: 9200
	cluster.initial_master_nodes: ["wangzheyi"]

注意:最后一个配置项是本机的Ip地址或映射



## 关闭防火墙

	systemctl stop firewalld.service  关闭防火墙
	systemctl disable firewalld.service   禁止开机启动
	firewall-cmd --state 查看防火墙状态

	


## 启动

	cd /es/elasticsearch-7.6.2/bin/
	./elasticsearch &


## 测试

访问：

	http://47.112.142.231:9200/

显示：

	{
	  "name" : "wangzheyi",
	  "cluster_name" : "elasticsearch",
	  "cluster_uuid" : "dEdBAbuwSzaMH4mmW2RSiw",
	  "version" : {
	    "number" : "7.6.2",
	    "build_flavor" : "default",
	    "build_type" : "tar",
	    "build_hash" : "ef48eb35cf30adf4db14086e8aabd07ef6fb113f",
	    "build_date" : "2020-03-26T06:34:37.794943Z",
	    "build_snapshot" : false,
	    "lucene_version" : "8.4.0",
	    "minimum_wire_compatibility_version" : "6.8.0",
	    "minimum_index_compatibility_version" : "6.0.0-beta1"
	  },
	  "tagline" : "You Know, for Search"
	}