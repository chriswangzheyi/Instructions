#8.高阶Transformation算子

## Demo

	package wzy
	
	import org.apache.flink.streaming.api.functions.co.CoMapFunction
	import org.apache.flink.streaming.api.scala._
	
	object advancedTransform {
	
	  def main(args: Array[String]): Unit = {
	
	    val env = StreamExecutionEnvironment.getExecutionEnvironment
	    env.setParallelism(10)
	
	    //union demo (合并多个同类型的数据流，并生成同类型的数据流)
	    val shenzhenStockStream = env.fromElements(("深圳指数",2000) )
	    val hongkongStockStream = env.fromElements(("香港指数",3000) )
	    val shanghaiStockStream = env.fromElements(("上海指数",4000) )
	    val unionStockStream = shenzhenStockStream.union(hongkongStockStream,shanghaiStockStream)
	    unionStockStream.print()
	
	    //10> (香港指数,3000)
	    //8> (深圳指数,2000)
	    //2> (上海指数,4000)
	
	    //connect demo (connect只能连接两个数据流,connect所连接的两个数据流的数据类型可以不一致)
	    val intStream= env.fromElements(1, 0, 9, 2, 3, 6)
	    val stringStream= env.fromElements("LOW", "HIGH", "LOW", "LOW")
	    val connectedStream = intStream.connect(stringStream)
	    // CoMapFunction三个泛型分别对应第一个流的输入、第二个流的输入，map之后的输出
	    class MyCoMapFunction extends CoMapFunction[Int, String, String] {
	
	      override def map1(input1: Int): String = input1.toString
	      override def map2(input2: String): String = input2
	    }
	
	    val mapResult = connectedStream.map(new MyCoMapFunction)
	    mapResult.print()
	
	    //6> 1
	    //1> 6
	    //8> 9
	    //6> HIGH
	    //5> LOW
	    //9> 2
	    //10> 3
	    //7> 0
	    //8> LOW
	    //7> LOW
	
	    env.execute("advance transformation")
	
	  }
	
	}
