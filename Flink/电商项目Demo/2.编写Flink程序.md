# 2.编写Flink程序

## launcher

	package com.wzy.stream.userPurchaseBehaviorTracker.start
	
	
	import org.apache.flink.streaming.api.{CheckpointingMode, TimeCharacteristic}
	import org.apache.flink.streaming.api.scala.StreamExecutionEnvironment
	
	object launcher {
	
	  def main(args: Array[String]): Unit = {
	
	    val env = StreamExecutionEnvironment.getExecutionEnvironment
	
	    env.setStreamTimeCharacteristic(TimeCharacteristic.EventTime)
	    env.enableCheckpointing(600000L)
	
	    val checkpointConfig=  env.getCheckpointConfig
	
	    checkpointConfig.setCheckpointingMode(CheckpointingMode.EXACTLY_ONCE)
	    checkpointConfig.setMinPauseBetweenCheckpoints(30000L)
	    checkpointConfig.setCheckpointTimeout(10000L)
	    checkpointConfig.enableExternalizedCheckpoints(checkpointConfig.getExternalizedCheckpointCleanup)
	
	
	  }
	
	}
