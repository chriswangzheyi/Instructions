# 14. 数据域会话聚合信息表

## 流量分析

### 创建会话聚合信息表

![](Images/14.png)

DWS: 数据汇总层，聚合性质，一般是宽表

####建库：

	CREATE DATABASE dws;

####建表：(session_aggregate)

	CREATE TABLE dws.mall_app_ses_agr(
		guid                 string,
		session_id           string,
		ses_start_time       bigint,
		ses_end_time         bigint,
		ses_pv_cnt           int,
		ses_enter_page       string,
		ses_is_jum          int    --1：跳出了会话 2:没有跳出会话
	) 
	PARTITIONED BY (dt string)
	STORED AS orc
	TABLEPROPERTIES('orc.compress' = 'snappy')
	;
	
### 计算

#### 逻辑

基于app行为事件明细表：

![](Images/15.png)

预计生成的数据格式：

![](Images/16.png)

#### 开发



 