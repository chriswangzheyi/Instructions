# 15. 流量分析主题宽表

## 后续使用场景

宽表完成后，为终端用户（数据的最终使用者）提供多维报表，有两种方式：

1. 要什么样的报表，就为它写什么样的sql临时计算！
2. 提前预计算（构建一个cube），等它要具体的报表时，我们就从cube中为它取数即可！


## 实现步骤

### 建表

建一个traffic流量的宽表wide table, 整合了dwd.mall_app_event_dtl 和 dws.mall_app_ses_agr表的信息，理论上还需要整合时间，这里略过。

	Creat Table dws.mall_app_tfc_wt(
	
	
	account                 string,                                  
	appid                   string,                                   
	appversion              string,                                     
	carrier                 string,                                 
	deviceid                string,                                  
	devicetype              string,                                   
	eventid                 string,                                
	ip                      string,                             
	latitude                double,                                
	longitude               double,                                 
	nettype                 string,                              
	osname                  string,                               
	osversion               string,                              
	properties              map<string,string>,                        
	releasechannel          string ,                                     
	resolution              string,                                 
	sessionid               string,                                
	ts                      string,                            
	splitsessionid          string,                               
	province                string,                             
	city                    string,                          
	district                string ,                          
	guid                    bigint ,    
	ses_enter_page_id       string,                                      
	ses_enter_page_url      string,                                      
	ses_exit_page_id        string,                                      
	ses_exit_page_url       string,                                      
	ses_is_jump             int                        
	)

