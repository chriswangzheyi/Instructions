**Springcloud 配置**


**1.创建一个git仓库**

创建一个microconfig仓库

![](../Images/47.png)



在microconfig中添加一个applicayion.yml：

	spring:
	  profiles:
	    active:
	    - dev
	---
	spring:
	  profiles: dev
	  application: 
	    name: microconfig-test-dev
	---
	spring:
	  profiles: default
	  application: 
	    name: microconfig-test-default



提交更新内容。

---


**2.修改host文件**

新增

    127.0.0.1 config-7001.com


此时的host文件：

    127.0.0.1 dept-8001.com
    127.0.0.1 dept-8002.com
    127.0.0.1 dept-8003.com
    127.0.0.1 client.com
    127.0.0.1 eureka-7001.com
    127.0.0.1 eureka-7002.com
    127.0.0.1 eureka-7003.com
    127.0.0.1 dashboard.com
    127.0.0.1 company-8101.com
    127.0.0.1 turbine.com
    127.0.0.1 gateway-9501.com
    127.0.0.1 upload.com
    127.0.0.1 consumer-upload.com
    127.0.0.1 config-7001.com
    

**3.新增config module**


在microcloud项目中添加一个Modlue:microcloud-config-7101

![](../Images/48.png)


**Config_7101_StartSpringCloudApplication:**

增加@EnableConfigServer注解


	package com.wzy;
	
	import org.springframework.boot.SpringApplication;
	import org.springframework.boot.autoconfigure.SpringBootApplication;
	import org.springframework.cloud.config.server.EnableConfigServer;
	@SpringBootApplication
	@EnableConfigServer
	public class Config_7101_StartSpringCloudApplication {
		public static void main(String[] args) {
			SpringApplication.run(Config_7101_StartSpringCloudApplication.class, args);
		}
	}



**application.yml：**
	
	server:
	  port: 7101
	spring: 
	  application:
	    name: microcloud-config
	  cloud:  # 进行SpringCloud的相关配置
	    config: # 进行SpringCloudConfig的相关配置
	      server: # 设置服务的连接地址
	        git:  # 本次使用的是GIT作为仓库的管理，所以需要设置GIT的连接地址
	          uri: https://github.com/chriswangzheyi/microconfig.git


**pom.xml：**
	
	<?xml version="1.0" encoding="UTF-8"?>
	<project xmlns="http://maven.apache.org/POM/4.0.0"
	         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
	    <parent>
	        <artifactId>microcloud</artifactId>
	        <groupId>com.wzy</groupId>
	        <version>1.0-SNAPSHOT</version>
	    </parent>
	    <modelVersion>4.0.0</modelVersion>
	
	    <artifactId>microcloud-config-7101</artifactId>
	    <name>microcloud-config-7101</name>
	    <url>http://maven.apache.org</url>
	    <properties>
	        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
	    </properties>
	    <dependencies>
	        <dependency>
	            <groupId>org.springframework.cloud</groupId>
	            <artifactId>spring-cloud-config-server</artifactId>
	        </dependency>
	        <dependency>
	            <groupId>com.wzy</groupId>
	            <artifactId>microcloud-security</artifactId>
	            <version>1.0-SNAPSHOT</version>
	        </dependency>
	        <dependency>
	            <groupId>org.springframework.boot</groupId>
	            <artifactId>spring-boot-starter-actuator</artifactId>
	        </dependency>
	        <dependency>
	            <groupId>org.springframework.cloud</groupId>
	            <artifactId>spring-cloud-starter-hystrix</artifactId>
	        </dependency>
	        <dependency>
	            <groupId>org.springframework.cloud</groupId>
	            <artifactId>spring-cloud-starter-eureka</artifactId>
	        </dependency>
	        <dependency>
	            <groupId>org.springframework.cloud</groupId>
	            <artifactId>spring-cloud-starter-config</artifactId>
	        </dependency>
	        <dependency>
	            <groupId>org.springframework.boot</groupId>
	            <artifactId>spring-boot-starter-jetty</artifactId>
	        </dependency>
	        <dependency>
	            <groupId>org.springframework.boot</groupId>
	            <artifactId>spring-boot-starter-web</artifactId>
	        </dependency>
	        <dependency>
	            <groupId>org.springframework.boot</groupId>
	            <artifactId>spring-boot-starter-test</artifactId>
	            <scope>test</scope>
	        </dependency>
	        <dependency>
	            <groupId>org.springframework</groupId>
	            <artifactId>springloaded</artifactId>
	        </dependency>
	        <dependency>
	            <groupId>org.springframework.boot</groupId>
	            <artifactId>spring-boot-devtools</artifactId>
	        </dependency>
	    </dependencies>
	</project>
	
---

**4.验证：**

访问：

    http://mldnjava:hello@config-7101.com:7101/master/application-dev.yml

得到反馈：

![](../Images/49.png)


访问格式： 

    http://{user}:{password}@config-7101.com:7101/{branch}/applicayion-{env}.yml