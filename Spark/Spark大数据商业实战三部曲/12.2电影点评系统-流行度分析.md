#12.2电影点评系统-流行度分析

## 前提条件
基于12.1

## 代码

在Movie_Users_analyzer_RDD后面加上

	   // 流行度分析
	    println("所有电影中平均得分最高的是：")
	    val ratings = ratingsRDD.map(_.split("::")).map(x => (x(0), x(1), x(2)) ).cache()  //UserID,MovieID,Rating
	    ratings.map(x => (x._2, (x._3.toDouble,1)))  // MovieID,(Rating,1)
	      .reduceByKey((x,y) =>(x._1+y._1,x._2+y._2)) //每部电影的总评分和总点评人数
	      .map( x => (x._2._1.toDouble/ x._2._2, x._1))//求出平均分
	      .sortByKey(false)//降序排列
	      .take(10)
	      .foreach(println)
	
	    println("观看人数最多的电影是：")
	    ratings.map( x => (x._2,1)).reduceByKey(_+_)
	      .map(x => (x._2,x._1))
	      .sortByKey(false)
	      .map( x=> (x._2,x._1))
	      .take(10)
	      .foreach(println)


## 打印

	所有电影中平均得分最高的是：
	(5.0,989)
	(5.0,787)
	(5.0,3656)
	(5.0,3881)
	(5.0,1830)
	(5.0,3382)
	(5.0,3607)
	(5.0,3280)
	(5.0,3233)
	(5.0,3172)
	
	观看人数最多的电影是：
	(2858,3428)
	(260,2991)
	(1196,2990)
	(1210,2883)
	(480,2672)
	(2028,2653)
	(589,2649)
	(2571,2590)
	(1270,2583)
	(593,2578)