**Jenkins持续集成**


**1.前置条件**

在Github上创建一个测试repository


编写一个简单测试微服务


![](../Images/8.png)


HelloController:

	package com.wzy.docker_springboot_demo.controller;
	
	import org.springframework.web.bind.annotation.RequestMapping;
	import org.springframework.web.bind.annotation.RequestMethod;
	import org.springframework.web.bind.annotation.RestController;
	
	@RestController
	public class HelloController {
	
	    @RequestMapping(value = "/hi", method = RequestMethod.GET)
	    public String hello() {
	        return "hi";
	    }
	
	}





DockerSpringbootDemoApplication:

	package com.wzy.docker_springboot_demo;
	
	import org.springframework.boot.SpringApplication;
	import org.springframework.boot.autoconfigure.SpringBootApplication;
	
	@SpringBootApplication
	public class DockerSpringbootDemoApplication {
	
	    public static void main(String[] args) {
	        SpringApplication.run(DockerSpringbootDemoApplication.class, args);
	    }
	
	}


application.properties:

    server.port=8081


pom:

	<?xml version="1.0" encoding="UTF-8"?>
	<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd">
	    <modelVersion>4.0.0</modelVersion>
	    <parent>
	        <groupId>org.springframework.boot</groupId>
	        <artifactId>spring-boot-starter-parent</artifactId>
	        <version>2.1.8.RELEASE</version>
	        <relativePath/> <!-- lookup parent from repository -->
	    </parent>
	    <groupId>com.wzy</groupId>
	    <artifactId>docker_springboot_demo</artifactId>
	    <version>0.0.1-SNAPSHOT</version>
	    <name>docker_springboot_demo</name>
	    <description>Demo project for Spring Boot</description>
	
	    <properties>
	        <java.version>1.8</java.version>
	    </properties>
	
	    <dependencies>
	        <dependency>
	            <groupId>org.springframework.boot</groupId>
	            <artifactId>spring-boot-starter</artifactId>
	        </dependency>
	
	        <dependency>
	            <groupId>org.springframework.boot</groupId>
	            <artifactId>spring-boot-starter-test</artifactId>
	            <scope>test</scope>
	        </dependency>
	
	        <dependency>
	            <groupId>org.springframework.boot</groupId>
	            <artifactId>spring-boot-starter-web</artifactId>
	        </dependency>
	
	    </dependencies>
	
	    <build>
	        <plugins>
	            <plugin>
	                <groupId>org.springframework.boot</groupId>
	                <artifactId>spring-boot-maven-plugin</artifactId>
	            </plugin>
	        </plugins>
	    </build>
	
	</project>




**2.生成秘钥**



打开本地git bash,使用如下命令生成ssh公钥和私钥对

    ssh-keygen -t rsa -C 'chriswangzheyi@hotmail.com'


然后一路回车(-C 参数是你的邮箱地址)



然后输入命令：

    # ~表示用户目录，比如我的windows就是C:\Users\Administrator，并复制其中的内容
    $ cat ~/.ssh/id_rsa.pub


打开文件得到秘钥：


    ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDkMwfZznS46+Ve+4/H66ExtLiZGt5Mk/w3+2MCPUB10msvnIStp+zYooVNvLUqPrRP3pgeSG/4uoFugAVNpLKEkJwzfufkFZrlCM9ePeQK1x7gltJdEL9MWQPCEvz4msQO7F4c6typlbceq4Kd+GZ4+/HrgagOO3dvMQfwuSiRhqBkijnOW4eQezMDZI6GZvCZ9KQfYck+RxdOGJyIVXrjo7TexmBpvFbTRM679C5iqavVflp5sWlEluoPRwqKrpvZAa2srZ/jhcGs6xYM9qd0gPBTQZh3tUYxmzlh/o+7zcMLFL/HBatgQwSyYeByRh/ns/oUbVBCI1I2DQjuBXOl chriswangzheyi@hotmail.com



登陆Github网站：

Settings --> SSH and GPG keys --> new SSH key


将上面的秘钥复制进来





---


**3.安装SSH插件**


![](../Images/13.png)



**4.配置SSH**

![](../Images/17.png)




**5.构建任务**

在Jenkins中：


![](../Images/9.png)



**源码管理：**

选择git, 

Repositories： 选择Git项目的https URL

Credentia： 无


![](../Images/14.png)


**构建触发器**



![](../Images/15.png)



**构建**

选择使用Maven构建：

goal: clean package

POM: {项目名}/pom.xml

![](../Images/16.png)


**构建后**

![](../Images/17.png)


Exec command：

    java -jar /root/jenkins/workspace/firstgitdemo/docker_springboot_demo/target/docker_springboot_demo-0.0.1-SNAPSHOT.jar
