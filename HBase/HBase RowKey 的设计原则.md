# HBase RowKey 的设计原则

## 设计原则

### 唯一原则
必须在设计上保证其唯一性。由于在HBase中数据存储是Key-Value形式，若HBase中同一表插入相同Rowkey，则原先的数据会被覆盖掉(如果表的version设置为1的话)，所以务必保证Rowkey的唯一性。

### 排序原则
HBase的Rowkey是按照ASCII有序设计的，我们在设计Rowkey时要充分利用这点。

例如：设计客户消费记录表时，可以把客户的id放在rowkey头部，这样通过客户id查询记录时，数据都存在同一个region中，查询效率就会提高。

### 散列原则

我们设计的Rowkey应均匀的分布在各个HBase节点上。但是热点key会导致数据都在一个RegionServer上堆积的热点现象。

### 长度原则

Rowkey是一个二进制，建议是越短越好。

例如：如果不涉及查询的字段就不要放到rowkey，如果只需要通过身份号查询，那就不用将名字、电话、地址其他信息放到rowkey中。

## RowKey字段选择

RowKey字段的选择，遵循的最基本原则是唯一性，RowKey必须能够唯一的识别一行数据。RowKey字段都应该参考最高频的查询场景。

数据库通常都是以如何高效的读取和消费数据为目的，而不是数据存储本身。

结合具体的负载特点，再对选取的RowKey字段值进行改造，组合字段场景下需要重点考虑字段的顺序。

## 避免热点的方法

可以倒转rowkey


