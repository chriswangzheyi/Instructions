# Hashmap

## 数据结构

JDK7中使用的是数组+链表的结构。JDK8中使用的是数组+链表+红黑树，在链表长度大于8时转为红黑树。

数组的优点：易查找，不易进行增加修改操作。（通过下标查找）

链表的优点：易进行增加修改，不易进行查找。（通过遍历查找）


## 选择红黑树的原因

二叉树在特定情况下，会形成一条线的结构，这跟链表查询的一样了，造成查询很深的问题，遍历查询会变的非常的慢，红黑树就是为了查询速度快，解决链表查询深度的问题，我们知道红黑树是属于平衡二叉树，但是为了保持平衡是需要付出代价的，但是该代价所损耗的资源要比遍历线性链表要少，所以当长度大于8的时候，会使用红黑树，如果链表的长度很短 的话，使用红黑树，反而会更慢。


## 红黑树特点

![](../Images/1.png)


1、每一个节点非红即黑

2、根节点总是黑色的

3、如果节点是红色的，则它的子节点必须是黑色的（反之不一定）

4、每个叶子的节点都是黑色的空节点（NULL）

5、从任意节点到其每个叶子的所有路径都包含相同的黑色节点


## 扩容 resize

在插入新数据以及首次插入数据时，HashMap都进行了一次判断是否需要扩容。我们知道Java中数组的长度是固定的，当我们需要扩容时，肯定需要用一个新的数组来替换老的数组，并将数据迁移过去。而这些操作在HashMap中全部体现在resize()方法中.长度是2的幂次方的原因是hash码转换为二进制的时候，不容易产生hash碰撞。



